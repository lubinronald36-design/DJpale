<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Neon Audio â€” Final</title>
<style>
  :root{
    --bg:#05050a;
    --panel:#0c0c10;
    --neon1:#00ffcc;
    --neon2:#9b4cff;
    --voice-glow:#6af0d6;
    --btn-radius:12px;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#04040a 0%,#0b0b11 100%);font-family:Inter,Arial,Helvetica,sans-serif;color:#e6f7ff}
  .wrap{max-width:460px;margin:18px auto;padding:18px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 10px 40px rgba(0,0,0,0.6);text-align:center}
  h1{margin:6px 0 8px;font-size:20px;letter-spacing:1.5px}
  .subtitle{font-size:12px;opacity:.78;margin-bottom:10px}
  .btn{display:block;width:100%;padding:14px 12px;margin:8px 0;border-radius:var(--btn-radius);border:0;cursor:pointer;font-weight:800;color:#fff;font-size:15px;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));box-shadow:0 6px 20px rgba(0,0,0,0.6);transition:transform .08s ease, box-shadow .08s, filter .08s;outline:none;text-align:left}
  .btn:active{transform:translateY(1px)}
  .neon.music{ background: linear-gradient(90deg,var(--neon1) 20%, var(--neon2) 100%); box-shadow:0 8px 20px rgba(155,76,255,0.06), 0 0 18px rgba(0,255,204,0.06); }
  .neon.voice{ background: linear-gradient(90deg,#33ffe0 20%, #6a4bff 100%); box-shadow:0 8px 18px rgba(100,70,255,0.06); }
  .neon.stop{ background: linear-gradient(90deg,#ff4f80, #ff9b4f); box-shadow: 0 8px 18px rgba(255,100,120,0.06); color:#0b0b0b; }
  .playing{ filter:brightness(1.06) drop-shadow(0 8px 30px rgba(0,0,0,0.45)); }
  .labelSmall{font-size:12px;opacity:.85;margin:6px 0 4px;text-align:left}
  .hint{font-size:11px;opacity:0.72;margin-top:8px}
  .eq{display:flex;gap:6px;align-items:end;justify-content:center;margin-top:12px}
  .bar{width:8px;height:12px;background:rgba(255,255,255,0.06);border-radius:4px;transition:height .08s linear, background .08s}
  .bar.active{ background:linear-gradient(180deg,var(--neon1),#8b3cff); }
  input[type=range]{width:100%;margin-top:10px}
  .status{font-size:12px;opacity:.85;margin-top:8px}
  @media (max-width:420px){ .wrap{margin:12px} .btn{padding:12px;font-size:14px} }
</style>
</head>
<body>
  <div class="wrap" id="panel">
    <h1 class="neon">Neon Audio â€” Final</h1>
    <div class="subtitle">Vertical layout Â· Keys: 1â€“5 = Music 1â€“5 Â· Q/W/E = Voice 1â€“3 Â· SPACE = STOP ALL</div>

    <div class="labelSmall">Music</div>
    <button id="m1" class="btn neon music">ðŸŽµ Music 1 &nbsp;<span style="float:right">Key 1</span></button>
    <button id="m2" class="btn neon music">ðŸŽµ Music 2 &nbsp;<span style="float:right">Key 2</span></button>
    <button id="m3" class="btn neon music">ðŸŽµ Music 3 &nbsp;<span style="float:right">Key 3</span></button>
    <button id="m4" class="btn neon music">ðŸŽµ Music 4 &nbsp;<span style="float:right">Key 4</span></button>
    <button id="m5" class="btn neon music">ðŸŽµ Music 5 &nbsp;<span style="float:right">Key 5</span></button>

    <div class="labelSmall" style="margin-top:8px">Voices (exclusive)</div>
    <button id="v1" class="btn neon voice">ðŸŽ¤ Voice 1 &nbsp;<span style="float:right">Key Q</span></button>
    <button id="v2" class="btn neon voice">ðŸŽ¤ Voice 2 &nbsp;<span style="float:right">Key W</span></button>
    <button id="v3" class="btn neon voice">ðŸŽ¤ Voice 3 &nbsp;<span style="float:right">Key E</span></button>

    <button id="stopAll" class="btn neon stop">â–  STOP ALL &nbsp;<span style="float:right">Key SPACE</span></button>

    <div class="labelSmall">Master volume</div>
    <input id="master" type="range" min="0" max="100" value="100">

    <div class="eq" id="eq">
      <div class="bar" id="b1"></div>
      <div class="bar" id="b2"></div>
      <div class="bar" id="b3"></div>
      <div class="bar" id="b4"></div>
      <div class="bar" id="b5"></div>
    </div>

    <div class="status" id="status">Status: Ready</div>
    <div class="hint">Tip: click buttons or press keys. Scrolling won't stop playback.</div>
  </div>

<script>
/* ===== Settings ===== */
const DUCK_VOLUME = 0.20;
const NORMAL_VOLUME = 1.0;
const FADE_STEP = 0.08;
const FADE_INTERVAL = 40;

/* ===== Files (must exist in same folder) ===== */
const FILES = {
  music1: "cue.mp3",
  music2: "cue2.mp3",
  music3: "rony.mp3",
  music4: "Sony.mp3",
  music5: "tony.mp3",
  voice1: "elp.mp3",
  voice2: "ronald.mp3",
  voice3: "voice3.mp3"
};

/* ===== Create audio objects ===== */
const mus1 = new Audio(FILES.music1);
const mus2 = new Audio(FILES.music2);
const mus3 = new Audio(FILES.music3);
const mus4 = new Audio(FILES.music4);
const mus5 = new Audio(FILES.music5);
const v1 = new Audio(FILES.voice1);
const v2 = new Audio(FILES.voice2);
const v3 = new Audio(FILES.voice3);

[mus1,mus2,mus3,mus4,mus5].forEach(p => { p.loop = false; p.preload="auto"; p._base = 1.0; });
[v1,v2,v3].forEach(p => { p.loop = false; p.preload="auto"; p._base = 1.0; });

const musicMap = { m1: mus1, m2: mus2, m3: mus3, m4: mus4, m5: mus5 };
const voiceMap = { v1: v1, v2: v2, v3: v3 };

/* Master volume */
let masterVol = 1.0;
function applyMaster(){
  Object.values(musicMap).forEach(p => p.volume = Math.max(0, Math.min(1, (p._cur ?? p._base) * masterVol)));
  Object.values(voiceMap).forEach(p => p.volume = Math.max(0, Math.min(1, p._base * masterVol)));
}

/* UI refs */
const statusEl = document.getElementById("status");
const eqBars = [...document.querySelectorAll(".bar")];
const masterEl = document.getElementById("master");

function setStatus(t){ statusEl.textContent = "Status: " + t; animateEQ(); }

/* ===== EQ animation ===== */
function animateEQ(){
  const any = Object.values(musicMap).some(p => !p.paused) || Object.values(voiceMap).some(p => !p.paused);
  if (any){
    eqBars.forEach(b => { b.classList.add("active"); b.style.height = (12 + Math.floor(Math.random()*60)) + "px"; });
  } else {
    eqBars.forEach((b,i) => { b.classList.remove("active"); b.style.height = (12 + i*3) + "px"; });
  }
}

/* ===== Fade (duck / restore) ===== */
let fadeHandle = null;
function fadeMusicTo(target, cb){
  clearInterval(fadeHandle);
  fadeHandle = setInterval(() => {
    let allDone = true;
    Object.values(musicMap).forEach(p => {
      if (p._cur === undefined) p._cur = p._base;
      if (Math.abs(p._cur - target) > FADE_STEP){ p._cur = Math.max(0, Math.min(1, p._cur + (p._cur < target ? FADE_STEP : -FADE_STEP))); allDone = false; }
      else p._cur = target;
      p.volume = Math.max(0, Math.min(1, p._cur * masterVol));
    });
    if (allDone){ clearInterval(fadeHandle); fadeHandle = null; if (cb) cb(); }
  }, FADE_INTERVAL);
}

/* Track active voices (for duck logic) */
let activeVoiceCount = 0;

/* ===== Voice exclusivity helpers ===== */
function stopOtherVoices(exceptId){
  Object.keys(voiceMap).forEach(id => {
    if (id !== exceptId){
      const p = voiceMap[id];
      if (!p.paused){ p.pause(); p.currentTime = 0; document.getElementById(id).classList.remove("playing"); if (activeVoiceCount>0) activeVoiceCount--; }
    }
  });
  if (activeVoiceCount <= 0){ activeVoiceCount = 0; fadeMusicTo(1.0); }
}

/* when a voice starts/stops */
function voiceStarted(){
  activeVoiceCount = Math.max(0, activeVoiceCount) + 1;
  if (activeVoiceCount === 1) fadeMusicTo(DUCK_VOLUME);
}
function voiceStopped(){
  activeVoiceCount = Math.max(0, activeVoiceCount-1);
  if (activeVoiceCount <= 0){ activeVoiceCount = 0; fadeMusicTo(1.0); }
}

/* ===== Toggle player (music or voice) ===== */
function toggle(buttonId, player, isVoice=false){
  const btn = document.getElementById(buttonId);
  if (player.paused){
    if (isVoice){
      stopOtherVoices(buttonId);
      player.currentTime = 0;
      player.play().catch(()=> setStatus("Playback blocked â€” tap screen"));
      btn.classList.add("playing");
      voiceStarted();
      player.onended = () => { btn.classList.remove("playing"); voiceStopped(); setStatus(buttonId + " ended"); };
      setStatus(buttonId + " playing");
    } else {
      // music
      if (player._cur === undefined) player._cur = player._base;
      player.play().catch(()=> setStatus("Playback blocked â€” tap screen"));
      btn.classList.add("playing");
      player.onended = () => { btn.classList.remove("playing"); setStatus(buttonId + " ended"); };
      setStatus(buttonId + " playing");
    }
  } else {
    player.pause();
    btn.classList.remove("playing");
    setStatus(buttonId + " paused");
    if (isVoice) voiceStopped();
  }
  animateEQ();
}

/* ===== Stop All ===== */
function stopAll(){
  Object.keys(musicMap).forEach(id => { const p = musicMap[id]; p.pause(); p.currentTime = 0; document.getElementById(id).classList.remove("playing"); p._cur = p._base; });
  Object.keys(voiceMap).forEach(id => { const p = voiceMap[id]; p.pause(); p.currentTime = 0; document.getElementById(id).classList.remove("playing"); });
  activeVoiceCount = 0;
  fadeMusicTo(1.0);
  setStatus("All stopped");
  animateEQ();
}

/* ===== Wire buttons ===== */
document.getElementById("m1").addEventListener("click", () => toggle("m1", musicMap.m1, false));
document.getElementById("m2").addEventListener("click", () => toggle("m2", musicMap.m2, false));
document.getElementById("m3").addEventListener("click", () => toggle("m3", musicMap.m3, false));
document.getElementById("m4").addEventListener("click", () => toggle("m4", musicMap.m4, false));
document.getElementById("m5").addEventListener("click", () => toggle("m5", musicMap.m5, false));

document.getElementById("v1").addEventListener("click", () => toggle("v1", voiceMap.v1, true));
document.getElementById("v2").addEventListener("click", () => toggle("v2", voiceMap.v2, true));
document.getElementById("v3").addEventListener("click", () => toggle("v3", voiceMap.v3, true));

document.getElementById("stopAll").addEventListener("click", stopAll);

/* ===== Master volume control ===== */
masterEl.addEventListener("input", (e) => { masterVol = Number(e.target.value)/100; applyMaster(); setStatus("Master: " + Math.round(masterVol*100) + "%"); });

applyMaster(); animateEQ();

/* ===== Keyboard shortcuts =====
   1-5 = music; q/w/e = voices; space = stop all
*/
window.addEventListener("keydown", (ev) => {
  const k = ev.key.toLowerCase();
  if (document.activeElement.tagName === "INPUT" || document.activeElement.tagName === "TEXTAREA") return;
  if (k === "1") document.getElementById("m1").click();
  if (k === "2") document.getElementById("m2").click();
  if (k === "3") document.getElementById("m3").click();
  if (k === "4") document.getElementById("m4").click();
  if (k === "5") document.getElementById("m5").click();
  if (k === "q") document.getElementById("v1").click();
  if (k === "w") document.getElementById("v2").click();
  if (k === "e") document.getElementById("v3").click();
  if (k === " ") { ev.preventDefault(); stopAll(); }
});

/* Safety: stop audio on unload */
window.addEventListener("beforeunload", () => { try{ stopAll(); } catch(e){} });

/* initial status */
setStatus("Ready");
</script>
</body>
</html>
